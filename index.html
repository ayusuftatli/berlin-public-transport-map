<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My handcrafted map</title>
    <link rel="stylesheet" href="map.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
</head>

<body>
    <div id="map">
    </div>
    <div id="controls">
        <div class="filter-handle">
            <div class="handle-bar"></div>
            <span class="handle-text">Filters</span>
        </div>
        <div hidden id="debugging-controls">
            <button id="refresh-button">Refresh</button>
            <div id="rate-limit-card">
                <span class="label">API Requests:</span>
                <span id="rate-count">0/100</span>
                <span class="label">/min</span>
                <div id="marker-count"></div>
                <button id="polygon-button">Polygon <span id="polygon-button-span">Off</span></button>
            </div>
        </div>

        <fieldset id="movement-filter" class="filter">
            <legend>Vehicles</legend>
            <div>
                <input type="checkbox" id="subway" name="subway" value="subway" checked />
                <label for="subway">U-Bahn</label>
            </div>
            <div>
                <input type="checkbox" id="tram" name="tram" value="tram" checked />
                <label for="tram">Tram</label>
            </div>
            <div>
                <input type="checkbox" id="suburban" name="suburban" value="suburban" checked />
                <label for="suburban">S-Bahn</label>
            </div>
            <div>
                <input type="checkbox" id="bus" name="bus" value="bus" />
                <label for="bus">Bus</label>
            </div>
            <div>
                <input type="checkbox" id="regional" name="regional" value="regional" />
                <label for="regional">Regional Train</label>
            </div>
            <div>
                <input type="checkbox" id="express" name="express" value="express" />
                <label for="express">Express Train</label>
            </div>
        </fieldset>

        <fieldset id="line-filter" class="filter">
            <legend>Routes</legend>
            <div>
                <input type="checkbox" id="subway_line" name="subway_line" value="subway_line" checked />
                <label for="subway_line">U-Bahn</label>
            </div>
            <div>
                <input type="checkbox" id="tram_line" name="tram_line" value="tram_line" checked />
                <label for="tram_line">Tram</label>
            </div>
            <div>
                <input type="checkbox" id="suburban_line" name="suburban_line" value="suburban_line" checked />
                <label for="suburban_line">S-Bahn</label>
            </div>
            <div>
                <input type="checkbox" id="bus_line" name="bus_line" value="bus_line" />
                <label for="bus_line">Bus</label>
            </div>
        </fieldset>

        <fieldset id="stations-filter" class="filter">
            <legend>Stations</legend>
            <div>
                <input type="checkbox" id="show_stations" name="show_stations" value="stations" checked />
                <label for="show_stations">Show Stations</label>
            </div>
        </fieldset>

    </div>
    <script>
        // Bottom sheet toggle for mobile
        document.addEventListener('DOMContentLoaded', () => {
            const controls = document.getElementById('controls');
            const filterHandle = document.querySelector('.filter-handle');

            if (filterHandle) {
                filterHandle.addEventListener('click', () => {
                    controls.classList.toggle('open');
                });

                // Close when tapping outside on mobile
                document.addEventListener('click', (e) => {
                    if (window.innerWidth <= 768 &&
                        controls.classList.contains('open') &&
                        !controls.contains(e.target)) {
                        controls.classList.remove('open');
                    }
                });

                // Prevent closing when clicking inside controls
                controls.addEventListener('click', (e) => {
                    e.stopPropagation();
                });
            }
        });
    </script>
    <script type="module" src="rateLimitUI.js"></script>
    <script type="module" src="map.js"></script>
</body>



</html>